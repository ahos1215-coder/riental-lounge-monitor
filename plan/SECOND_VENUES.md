# SECOND_VENUES
Last updated: 2025-12-29 / commit: 4299ff1

## Current UX (map-link 方針)
- UI は **map-link** のみ（Google Maps 検索リンクを生成）。
- `frontend/src/app/hooks/useSecondVenues.ts` がローカル設定からリンクを生成し、ネットワークアクセスは行わない。

## Backend API (互換・将来用)
- `GET /api/second_venues` は Supabase `second_venues` を読む（未設定時は `{ ok:true, rows: [] }`）。
- Next.js API route `/api/second_venues` は backend へ proxy する。
- 現状の UI は map-link 優先のため、API は未使用でも残置する。

## Optional / Legacy
- `/tasks/update_second_venues` は `GOOGLE_PLACES_API_KEY` がある場合のみ実行。
- Places API 依存の自動収集/保存に戻さない（map-link を本流とする）。

## Table Schema (legacy reference)
```sql
create table if not exists public.second_venues (
    id bigint generated by default as identity primary key,
    store_id text not null,
    place_id text not null,
    name text not null,
    lat double precision not null,
    lng double precision not null,
    genre text,
    address text,
    open_now boolean,
    weekday_text text[],
    updated_at timestamptz not null default timezone('utc', now()),
    constraint second_venues_store_place_key unique (store_id, place_id)
);

create index if not exists second_venues_store_id_idx on public.second_venues(store_id);
```
