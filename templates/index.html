<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ORIENTAL LOUNGE</title>
  <meta name="theme-color" content="#0b0b0b">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Noto+Sans+JP:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{
      color-scheme: dark;
      --men:      #3b82f6;
      --men-bg:   rgba(59,130,246,.18);
      --women:    #ec4899;
      --women-bg: rgba(236,72,153,.18);
      --total:    #93c5fd;
      --grid:     rgba(200,200,200,.08);
      --axis:     #cfcfcf;
      --purple:   #a855f7;
      --purple-f: rgba(168,85,247,.10);
      --card-bg:  #111318;
      --card-br:  #1f2430;
    }
    html,body{
      background:#0b0b0b;
      font-family:'Inter','Noto Sans JP',system-ui,-apple-system,Segoe UI,Roboto,'ヒラギノ角ゴ ProN','メイリオ',Arial,sans-serif
    }
    .card{background:var(--card-bg);border:1px solid var(--card-br);box-shadow:0 12px 30px rgba(0,0,0,.45)}
    .chip{border:1px solid rgba(255,255,255,.12)}
    .lift{transition:transform .18s ease, box-shadow .18s ease}
    .lift:hover{transform:translateY(-2px); box-shadow:0 14px 34px rgba(0,0,0,.55)}
    .pill{backdrop-filter: blur(6px); border:1px solid rgba(255,255,255,.14)}
  </style>
</head>
<body class="text-zinc-100">
  <!-- Header -->
  <header class="sticky top-0 z-50 border-b border-zinc-800 bg-black/70 backdrop-blur">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 py-3 flex items-center gap-3">
      <div class="h-8 w-8 rounded bg-zinc-900 grid place-items-center ring-1 ring-zinc-800">
        <div class="flex gap-0.5"><span class="block w-0.5 h-5 bg-zinc-300"></span><span class="block w-0.5 h-6 bg-zinc-300"></span><span class="block w-0.5 h-4 bg-zinc-300"></span></div>
      </div>
      <div class="text-lg sm:text-xl font-extrabold tracking-wide">ORIENTAL LOUNGE</div>
      <div class="ml-2 text-zinc-400 text-sm">(長崎)</div>
      <div class="ml-auto flex items-center gap-2 text-sm">
        <div id="clock" class="rounded chip px-2 py-1 text-zinc-300">--:-- 更新</div>
        <button id="btn-reload" class="rounded chip px-2 py-1 hover:bg-zinc-800">再読込</button>
      </div>
    </div>
  </header>

  <!-- KPI Row -->
  <section class="border-b border-zinc-800/80 bg-gradient-to-b from-black to-zinc-950/60">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 py-6 grid grid-cols-2 md:grid-cols-4 gap-3">
      <div class="card rounded-2xl p-4 lift">
        <div class="text-xs text-zinc-400">現在 男</div>
        <div class="mt-1 text-2xl font-extrabold" style="color:var(--men)" id="k-men">0</div>
      </div>
      <div class="card rounded-2xl p-4 lift">
        <div class="text-xs text-zinc-400">現在 女</div>
        <div class="mt-1 text-2xl font-extrabold" style="color:var(--women)" id="k-women">0</div>
      </div>
      <div class="card rounded-2xl p-4 lift">
        <div class="text-xs text-zinc-400">現在 合計</div>
        <div class="mt-1 text-2xl font-extrabold" style="color:var(--total)" id="k-total">0</div>
      </div>
      <div class="card rounded-2xl p-4 lift">
        <div class="text-xs text-zinc-400">本日 取得件数</div>
        <div id="k-hits" class="mt-1 text-2xl font-extrabold">0</div>
      </div>
    </div>
  </section>

  <!-- 今日の推移 -->
  <section class="mx-auto max-w-6xl px-4 sm:px-6 pb-6">
    <div class="card rounded-2xl p-4 lift">
      <h3 class="text-sm text-zinc-300 mb-2">本日の推移（10分刻み：合計 / 男性 / 女性）</h3>
      <div class="h-[340px]"><canvas id="chart"></canvas></div>
    </div>
  </section>

  <script>
    // 色
    const css = getComputedStyle(document.documentElement);
    const C_TOTAL = css.getPropertyValue('--total').trim();
    const C_MEN   = css.getPropertyValue('--men').trim();
    const C_WOMEN = css.getPropertyValue('--women').trim();
    const GRID    = css.getPropertyValue('--grid').trim();
    const AXIS    = css.getPropertyValue('--axis').trim();

    // 共通 Y 軸オプション
    function dynamicY() {
      return {
        beginAtZero:true,
        grid:{color:GRID},
        ticks:{color:AXIS},
        afterDataLimits(scale){
          const max = scale.max;
          scale.max = (max > 0 ? max * 1.5 : 1);
        }
      }
    }

    // 実績チャート
    const ctx = document.getElementById('chart').getContext('2d');
    const chart = new Chart(ctx, {
      type:'line',
      data:{ labels:[], datasets:[
        {label:'合計', data:[], borderColor:C_TOTAL, backgroundColor:'rgba(147,197,253,.22)', tension:.35, fill:true},
        {label:'男性', data:[], borderColor:C_MEN,   backgroundColor:'rgba(59,130,246,.18)', tension:.35, fill:false},
        {label:'女性', data:[], borderColor:C_WOMEN, backgroundColor:'rgba(236,72,153,.18)', tension:.35, fill:false}
      ]},
      options:{
        scales:{ x:{grid:{color:GRID},ticks:{color:AXIS}}, y:dynamicY() },
        plugins:{legend:{labels:{color:'#ddd'}}},
        maintainAspectRatio:false
      }
    });
  </script>
</body>
</html>
